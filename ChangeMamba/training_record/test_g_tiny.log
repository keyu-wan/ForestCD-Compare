[INFO] test samples: 284
=> merge config from /mnt/project-data/kwan/AI_Forestry/model/MambaCD/changedetection/configs/vssm1/vssm_tiny_224_0229flex.yaml
[INFO] loaded weights from /mnt/project-data/kwan/AI_Forestry/model/MambaCD/changedetection/saved_models/REDD/MambaBCD_Tiny_1759021304.556828/best.pth
Infer(Test):   0%|          | 0/284 [00:00<?, ?it/s]/mnt/project-data/kwan/AI_Forestry/model/MambaCD/infer.py:211: DeprecationWarning: numpy.core._internal is deprecated and has been renamed to numpy._core._internal. The numpy._core namespace contains private NumPy internals and its use is discouraged, as NumPy internals can change without warning in any release. In practice, most real-world usage of numpy.core is to access functionality in the public NumPy API. If that is the case, use the public NumPy API. If not, you are using NumPy internals. If you would still like to access an internal attribute, use numpy._core._internal.npy_ctypes_check.
  labels_np = labels_t.squeeze(0).detach().cpu().numpy().astype(np.int64)
Infer(Test):   0%|          | 1/284 [00:00<03:39,  1.29it/s]Infer(Test):   1%|          | 2/284 [00:00<01:48,  2.61it/s]Infer(Test):   1%|▏         | 4/284 [00:01<00:59,  4.69it/s]Infer(Test):   2%|▏         | 5/284 [00:01<00:51,  5.44it/s]Infer(Test):   2%|▏         | 7/284 [00:01<00:39,  6.97it/s]Infer(Test):   3%|▎         | 8/284 [00:01<00:37,  7.32it/s]Infer(Test):   3%|▎         | 9/284 [00:01<00:36,  7.58it/s]Infer(Test):   4%|▎         | 10/284 [00:01<00:33,  8.10it/s]Infer(Test):   4%|▍         | 11/284 [00:01<00:32,  8.34it/s]Infer(Test):   4%|▍         | 12/284 [00:01<00:31,  8.51it/s]Infer(Test):   5%|▍         | 13/284 [00:02<00:32,  8.46it/s]Infer(Test):   5%|▌         | 15/284 [00:02<00:29,  9.24it/s]Infer(Test):   6%|▌         | 16/284 [00:02<00:29,  9.12it/s]Infer(Test):   6%|▌         | 17/284 [00:02<00:30,  8.84it/s]Infer(Test):   6%|▋         | 18/284 [00:02<00:30,  8.72it/s]Infer(Test):   7%|▋         | 20/284 [00:02<00:28,  9.19it/s]Infer(Test):   7%|▋         | 21/284 [00:02<00:29,  8.99it/s]Infer(Test):   8%|▊         | 23/284 [00:03<00:27,  9.44it/s]Infer(Test):   8%|▊         | 24/284 [00:03<00:27,  9.38it/s]Infer(Test):   9%|▉         | 25/284 [00:03<00:28,  9.13it/s]Infer(Test):  10%|▉         | 27/284 [00:03<00:26,  9.58it/s]Infer(Test):  10%|█         | 29/284 [00:03<00:26,  9.48it/s]Infer(Test):  11%|█         | 30/284 [00:03<00:27,  9.25it/s]Infer(Test):  11%|█▏        | 32/284 [00:04<00:27,  9.20it/s]Infer(Test):  12%|█▏        | 33/284 [00:04<00:28,  8.95it/s]Infer(Test):  12%|█▏        | 34/284 [00:04<00:27,  9.04it/s]Infer(Test):  13%|█▎        | 36/284 [00:04<00:26,  9.20it/s]Infer(Test):  13%|█▎        | 37/284 [00:04<00:27,  8.97it/s]Infer(Test):  13%|█▎        | 38/284 [00:04<00:26,  9.20it/s]Infer(Test):  14%|█▎        | 39/284 [00:04<00:26,  9.15it/s]Infer(Test):  14%|█▍        | 40/284 [00:05<00:27,  8.98it/s]Infer(Test):  14%|█▍        | 41/284 [00:05<00:27,  8.81it/s]Infer(Test):  15%|█▌        | 43/284 [00:05<00:26,  9.14it/s]Infer(Test):  15%|█▌        | 44/284 [00:05<00:26,  8.95it/s]Infer(Test):  16%|█▌        | 45/284 [00:05<00:26,  8.93it/s]Infer(Test):  16%|█▌        | 46/284 [00:05<00:26,  8.96it/s]Infer(Test):  17%|█▋        | 47/284 [00:05<00:26,  9.02it/s]Infer(Test):  17%|█▋        | 48/284 [00:05<00:26,  8.86it/s]Infer(Test):  17%|█▋        | 49/284 [00:06<00:25,  9.10it/s]Infer(Test):  18%|█▊        | 51/284 [00:06<00:25,  9.26it/s]Infer(Test):  18%|█▊        | 52/284 [00:06<00:25,  9.05it/s]Infer(Test):  19%|█▊        | 53/284 [00:06<00:26,  8.87it/s]Infer(Test):  19%|█▉        | 55/284 [00:06<00:24,  9.30it/s]Infer(Test):  20%|█▉        | 56/284 [00:06<00:25,  9.04it/s]Infer(Test):  20%|██        | 57/284 [00:06<00:25,  8.96it/s]Infer(Test):  21%|██        | 59/284 [00:07<00:23,  9.40it/s]Infer(Test):  21%|██        | 60/284 [00:07<00:24,  8.98it/s]Infer(Test):  21%|██▏       | 61/284 [00:07<00:25,  8.75it/s]Infer(Test):  22%|██▏       | 63/284 [00:07<00:23,  9.24it/s]Infer(Test):  23%|██▎       | 64/284 [00:07<00:24,  9.07it/s]Infer(Test):  23%|██▎       | 65/284 [00:07<00:24,  8.91it/s]Infer(Test):  24%|██▎       | 67/284 [00:08<00:23,  9.10it/s]Infer(Test):  24%|██▍       | 68/284 [00:08<00:24,  8.93it/s]Infer(Test):  24%|██▍       | 69/284 [00:08<00:23,  9.10it/s]Infer(Test):  25%|██▌       | 71/284 [00:08<00:23,  9.20it/s]Infer(Test):  25%|██▌       | 72/284 [00:08<00:23,  9.00it/s]Infer(Test):  26%|██▌       | 73/284 [00:08<00:23,  9.17it/s]Infer(Test):  26%|██▌       | 74/284 [00:08<00:23,  8.90it/s]Infer(Test):  26%|██▋       | 75/284 [00:08<00:23,  8.77it/s]Infer(Test):  27%|██▋       | 76/284 [00:09<00:23,  8.68it/s]Infer(Test):  27%|██▋       | 78/284 [00:09<00:22,  9.14it/s]Infer(Test):  28%|██▊       | 79/284 [00:09<00:22,  8.95it/s]Infer(Test):  28%|██▊       | 80/284 [00:09<00:22,  8.92it/s]Infer(Test):  29%|██▊       | 81/284 [00:09<00:23,  8.59it/s]Infer(Test):  29%|██▉       | 82/284 [00:09<00:23,  8.47it/s]Infer(Test):  29%|██▉       | 83/284 [00:09<00:23,  8.41it/s]Infer(Test):  30%|██▉       | 84/284 [00:09<00:22,  8.79it/s]Infer(Test):  30%|███       | 86/284 [00:10<00:21,  9.20it/s]Infer(Test):  31%|███       | 87/284 [00:10<00:21,  8.96it/s]Infer(Test):  31%|███       | 88/284 [00:10<00:23,  8.46it/s]Infer(Test):  31%|███▏      | 89/284 [00:10<00:22,  8.76it/s]Infer(Test):  32%|███▏      | 90/284 [00:10<00:22,  8.81it/s]Infer(Test):  32%|███▏      | 91/284 [00:10<00:22,  8.66it/s]Infer(Test):  32%|███▏      | 92/284 [00:10<00:21,  8.97it/s]Infer(Test):  33%|███▎      | 94/284 [00:11<00:20,  9.35it/s]Infer(Test):  33%|███▎      | 95/284 [00:11<00:20,  9.07it/s]Infer(Test):  34%|███▍      | 97/284 [00:11<00:19,  9.50it/s]Infer(Test):  35%|███▍      | 98/284 [00:11<00:20,  9.29it/s]Infer(Test):  35%|███▍      | 99/284 [00:11<00:20,  8.97it/s]Infer(Test):  36%|███▌      | 101/284 [00:11<00:19,  9.43it/s]Infer(Test):  36%|███▌      | 102/284 [00:11<00:19,  9.42it/s]Infer(Test):  36%|███▋      | 103/284 [00:12<00:19,  9.08it/s]Infer(Test):  37%|███▋      | 104/284 [00:12<00:19,  9.09it/s]Infer(Test):  37%|███▋      | 105/284 [00:12<00:19,  9.10it/s]Infer(Test):  37%|███▋      | 106/284 [00:12<00:20,  8.87it/s]Infer(Test):  38%|███▊      | 107/284 [00:12<00:20,  8.84it/s]Infer(Test):  38%|███▊      | 109/284 [00:12<00:19,  9.03it/s]Infer(Test):  39%|███▊      | 110/284 [00:12<00:19,  8.87it/s]Infer(Test):  39%|███▉      | 111/284 [00:12<00:19,  9.10it/s]Infer(Test):  40%|███▉      | 113/284 [00:13<00:18,  9.43it/s]Infer(Test):  40%|████      | 114/284 [00:13<00:18,  9.17it/s]Infer(Test):  41%|████      | 116/284 [00:13<00:17,  9.59it/s]Infer(Test):  41%|████      | 117/284 [00:13<00:17,  9.47it/s]Infer(Test):  42%|████▏     | 118/284 [00:13<00:18,  9.17it/s]Infer(Test):  42%|████▏     | 119/284 [00:13<00:17,  9.35it/s]Infer(Test):  43%|████▎     | 121/284 [00:13<00:17,  9.33it/s]Infer(Test):  43%|████▎     | 122/284 [00:14<00:17,  9.02it/s]Infer(Test):  44%|████▎     | 124/284 [00:14<00:16,  9.54it/s]Infer(Test):  44%|████▍     | 125/284 [00:14<00:16,  9.58it/s]Infer(Test):  44%|████▍     | 126/284 [00:14<00:17,  9.24it/s]Infer(Test):  45%|████▍     | 127/284 [00:14<00:16,  9.41it/s]Infer(Test):  45%|████▌     | 129/284 [00:14<00:16,  9.18it/s]Infer(Test):  46%|████▌     | 130/284 [00:14<00:17,  8.96it/s]Infer(Test):  46%|████▋     | 132/284 [00:15<00:16,  9.44it/s]Infer(Test):  47%|████▋     | 133/284 [00:15<00:16,  9.31it/s]Infer(Test):  47%|████▋     | 134/284 [00:15<00:16,  9.06it/s]Infer(Test):  48%|████▊     | 136/284 [00:15<00:15,  9.59it/s]Infer(Test):  48%|████▊     | 137/284 [00:15<00:15,  9.39it/s]Infer(Test):  49%|████▊     | 138/284 [00:15<00:16,  9.12it/s]Infer(Test):  49%|████▉     | 140/284 [00:16<00:15,  9.52it/s]Infer(Test):  50%|████▉     | 141/284 [00:16<00:15,  9.32it/s]Infer(Test):  50%|█████     | 142/284 [00:16<00:15,  9.03it/s]Infer(Test):  51%|█████     | 144/284 [00:16<00:14,  9.39it/s]Infer(Test):  51%|█████     | 145/284 [00:16<00:14,  9.31it/s]Infer(Test):  51%|█████▏    | 146/284 [00:16<00:15,  9.04it/s]Infer(Test):  52%|█████▏    | 148/284 [00:16<00:14,  9.55it/s]Infer(Test):  52%|█████▏    | 149/284 [00:16<00:14,  9.32it/s]Infer(Test):  53%|█████▎    | 150/284 [00:17<00:14,  9.02it/s]Infer(Test):  53%|█████▎    | 151/284 [00:17<00:14,  8.96it/s]Infer(Test):  54%|█████▍    | 153/284 [00:17<00:14,  9.27it/s]Infer(Test):  54%|█████▍    | 154/284 [00:17<00:14,  8.99it/s]Infer(Test):  55%|█████▍    | 156/284 [00:17<00:13,  9.48it/s]Infer(Test):  55%|█████▌    | 157/284 [00:17<00:13,  9.37it/s]Infer(Test):  56%|█████▌    | 158/284 [00:17<00:14,  8.76it/s]Infer(Test):  56%|█████▌    | 159/284 [00:18<00:13,  9.02it/s]Infer(Test):  56%|█████▋    | 160/284 [00:18<00:13,  8.93it/s]Infer(Test):  57%|█████▋    | 161/284 [00:18<00:13,  8.80it/s]Infer(Test):  57%|█████▋    | 162/284 [00:18<00:13,  8.91it/s]Infer(Test):  58%|█████▊    | 164/284 [00:18<00:13,  9.04it/s]Infer(Test):  58%|█████▊    | 165/284 [00:18<00:13,  8.88it/s]Infer(Test):  58%|█████▊    | 166/284 [00:18<00:13,  9.05it/s]Infer(Test):  59%|█████▉    | 168/284 [00:19<00:12,  9.10it/s]Infer(Test):  60%|█████▉    | 169/284 [00:19<00:12,  8.94it/s]Infer(Test):  60%|█████▉    | 170/284 [00:19<00:12,  9.16it/s]Infer(Test):  61%|██████    | 172/284 [00:19<00:11,  9.46it/s]Infer(Test):  61%|██████    | 173/284 [00:19<00:12,  9.18it/s]Infer(Test):  61%|██████▏   | 174/284 [00:19<00:11,  9.36it/s]Infer(Test):  62%|██████▏   | 176/284 [00:19<00:11,  9.51it/s]Infer(Test):  62%|██████▏   | 177/284 [00:20<00:11,  9.18it/s]Infer(Test):  63%|██████▎   | 179/284 [00:20<00:11,  9.19it/s]Infer(Test):  63%|██████▎   | 180/284 [00:20<00:11,  9.15it/s]Infer(Test):  64%|██████▎   | 181/284 [00:20<00:11,  8.94it/s]Infer(Test):  64%|██████▍   | 183/284 [00:20<00:10,  9.40it/s]Infer(Test):  65%|██████▍   | 184/284 [00:20<00:10,  9.17it/s]Infer(Test):  65%|██████▌   | 185/284 [00:20<00:11,  8.92it/s]Infer(Test):  65%|██████▌   | 186/284 [00:21<00:10,  9.14it/s]Infer(Test):  66%|██████▌   | 188/284 [00:21<00:10,  9.24it/s]Infer(Test):  67%|██████▋   | 189/284 [00:21<00:10,  9.01it/s]Infer(Test):  67%|██████▋   | 190/284 [00:21<00:10,  9.18it/s]Infer(Test):  68%|██████▊   | 192/284 [00:21<00:09,  9.40it/s]Infer(Test):  68%|██████▊   | 193/284 [00:21<00:09,  9.16it/s]Infer(Test):  69%|██████▊   | 195/284 [00:22<00:09,  9.55it/s]Infer(Test):  69%|██████▉   | 196/284 [00:22<00:09,  9.30it/s]Infer(Test):  69%|██████▉   | 197/284 [00:22<00:09,  9.04it/s]Infer(Test):  70%|███████   | 199/284 [00:22<00:09,  9.44it/s]Infer(Test):  70%|███████   | 200/284 [00:22<00:09,  9.23it/s]Infer(Test):  71%|███████   | 201/284 [00:22<00:09,  8.99it/s]Infer(Test):  71%|███████   | 202/284 [00:22<00:08,  9.19it/s]Infer(Test):  72%|███████▏  | 204/284 [00:22<00:08,  9.27it/s]Infer(Test):  72%|███████▏  | 205/284 [00:23<00:08,  9.01it/s]Infer(Test):  73%|███████▎  | 206/284 [00:23<00:08,  9.11it/s]Infer(Test):  73%|███████▎  | 208/284 [00:23<00:08,  9.30it/s]Infer(Test):  74%|███████▎  | 209/284 [00:23<00:08,  9.07it/s]Infer(Test):  74%|███████▍  | 210/284 [00:23<00:08,  9.21it/s]Infer(Test):  75%|███████▍  | 212/284 [00:23<00:07,  9.40it/s]Infer(Test):  75%|███████▌  | 213/284 [00:23<00:07,  9.10it/s]Infer(Test):  76%|███████▌  | 215/284 [00:24<00:07,  9.48it/s]Infer(Test):  76%|███████▌  | 216/284 [00:24<00:07,  9.28it/s]Infer(Test):  76%|███████▋  | 217/284 [00:24<00:07,  9.05it/s]Infer(Test):  77%|███████▋  | 219/284 [00:24<00:06,  9.51it/s]Infer(Test):  77%|███████▋  | 220/284 [00:24<00:06,  9.31it/s]Infer(Test):  78%|███████▊  | 221/284 [00:24<00:06,  9.05it/s]Infer(Test):  79%|███████▊  | 223/284 [00:25<00:06,  9.38it/s]Infer(Test):  79%|███████▉  | 224/284 [00:25<00:06,  9.18it/s]Infer(Test):  79%|███████▉  | 225/284 [00:25<00:06,  8.95it/s]Infer(Test):  80%|███████▉  | 227/284 [00:25<00:06,  9.04it/s]Infer(Test):  80%|████████  | 228/284 [00:25<00:06,  8.82it/s]Infer(Test):  81%|████████  | 229/284 [00:25<00:06,  9.05it/s]Infer(Test):  81%|████████▏ | 231/284 [00:25<00:05,  9.31it/s]Infer(Test):  82%|████████▏ | 232/284 [00:26<00:05,  9.02it/s]Infer(Test):  82%|████████▏ | 233/284 [00:26<00:05,  9.19it/s]Infer(Test):  83%|████████▎ | 235/284 [00:26<00:05,  9.33it/s]Infer(Test):  83%|████████▎ | 236/284 [00:26<00:05,  9.04it/s]Infer(Test):  84%|████████▍ | 238/284 [00:26<00:04,  9.45it/s]Infer(Test):  84%|████████▍ | 239/284 [00:26<00:04,  9.27it/s]Infer(Test):  85%|████████▍ | 240/284 [00:26<00:04,  8.98it/s]Infer(Test):  85%|████████▌ | 242/284 [00:27<00:04,  8.85it/s]Infer(Test):  86%|████████▌ | 243/284 [00:27<00:04,  8.65it/s]Infer(Test):  86%|████████▌ | 244/284 [00:27<00:04,  8.91it/s]Infer(Test):  87%|████████▋ | 246/284 [00:27<00:04,  9.07it/s]Infer(Test):  87%|████████▋ | 247/284 [00:27<00:04,  8.86it/s]Infer(Test):  87%|████████▋ | 248/284 [00:27<00:03,  9.07it/s]Infer(Test):  88%|████████▊ | 250/284 [00:28<00:03,  9.39it/s]Infer(Test):  88%|████████▊ | 251/284 [00:28<00:03,  9.10it/s]Infer(Test):  89%|████████▉ | 253/284 [00:28<00:03,  9.51it/s]Infer(Test):  89%|████████▉ | 254/284 [00:28<00:03,  9.30it/s]Infer(Test):  90%|████████▉ | 255/284 [00:28<00:03,  8.99it/s]Infer(Test):  90%|█████████ | 256/284 [00:28<00:03,  8.96it/s]Infer(Test):  90%|█████████ | 257/284 [00:28<00:02,  9.03it/s]Infer(Test):  91%|█████████ | 258/284 [00:28<00:02,  8.75it/s]Infer(Test):  91%|█████████ | 259/284 [00:29<00:02,  8.67it/s]Infer(Test):  92%|█████████▏| 261/284 [00:29<00:02,  8.92it/s]Infer(Test):  92%|█████████▏| 262/284 [00:29<00:02,  8.74it/s]Infer(Test):  93%|█████████▎| 263/284 [00:29<00:02,  8.70it/s]Infer(Test):  93%|█████████▎| 265/284 [00:29<00:02,  9.04it/s]Infer(Test):  94%|█████████▎| 266/284 [00:29<00:02,  8.83it/s]Infer(Test):  94%|█████████▍| 267/284 [00:29<00:01,  8.92it/s]Infer(Test):  95%|█████████▍| 269/284 [00:30<00:01,  9.39it/s]Infer(Test):  95%|█████████▌| 270/284 [00:30<00:01,  9.08it/s]Infer(Test):  95%|█████████▌| 271/284 [00:30<00:01,  9.28it/s]Infer(Test):  96%|█████████▌| 273/284 [00:30<00:01,  9.43it/s]Infer(Test):  96%|█████████▋| 274/284 [00:30<00:01,  9.11it/s]Infer(Test):  97%|█████████▋| 275/284 [00:30<00:00,  9.31it/s]Infer(Test):  98%|█████████▊| 277/284 [00:30<00:00,  9.32it/s]Infer(Test):  98%|█████████▊| 278/284 [00:31<00:00,  9.04it/s]Infer(Test):  99%|█████████▊| 280/284 [00:31<00:00,  9.41it/s]Infer(Test):  99%|█████████▉| 281/284 [00:31<00:00,  9.25it/s]Infer(Test):  99%|█████████▉| 282/284 [00:31<00:00,  9.00it/s]Infer(Test): 100%|██████████| 284/284 [00:31<00:00,  9.16it/s]Infer(Test): 100%|██████████| 284/284 [00:31<00:00,  8.93it/s]
========= TEST METRICS =========
Recall=0.808655, Precision=0.576084, OA=0.889065, F1=0.672839, IoU=0.506976, Kappa=0.608303
Confusion Matrix (rows=GT, cols=Pred, classes=[0,1]):
[[14424314  1562354]
 [  502387  2123169]]
[Class 0] Precision=0.966343 Recall=0.902271 F1=0.933209 IoU=0.874781
[Class 1] Precision=0.576084 Recall=0.808655 F1=0.672839 IoU=0.506976
=== Macro Average over classes ===
Precision=0.771213 Recall=0.855463 F1=0.803024 IoU=0.690878
[INFO] Saved detailed report to /mnt/project-data/kwan/AI_Forestry/model/MambaCD/changedetection/exports/g_tiny1_test2/test_metrics.json
